<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Artikel hinzuf√ºgen ‚Äì SCHOOLBOX</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header>
    <h1>Artikelverwaltung</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="shop.html">Shop</a>
      <a href="artikel_add.html" class="active">Artikel hinzuf√ºgen</a>
    </nav>
  </header>

  <section>
    <h2>Neuen Artikel hinzuf√ºgen</h2>
    <form id="artikelForm" class="form-box">
      <input type="text" id="titel" placeholder="Titel des Artikels" required />
      
      <textarea id="beschreibung" placeholder="Beschreibung des Artikels" rows="4" required></textarea>
      
      <input type="number" step="0.01" id="preis" placeholder="Preis (z.‚ÄØB. 14.99)" required />
      
      <input type="url" id="bild_url" placeholder="Bild-URL (z.‚ÄØB. https://...)" required />
      
      <select id="typ" required>
        <option value="">Auswahl: Kaufen oder Leihen</option>
        <option value="kaufen">Kaufen</option>
        <option value="leihen">Leihen</option>
      </select>
      
      <button type="submit">Artikel hinzuf√ºgen</button>
    </form>

    <p id="feedback"></p>
  </section>

  <footer>&copy; 2025 SCHOOLBOX Admin</footer>

  <script>
    // üîë Supabase Zugangsdaten (hier einsetzen!)
    const SUPABASE_URL = "https://DEIN-PROJEKT.supabase.co";  // <- anpassen
    const SUPABASE_KEY = "DEIN-ANON-KEY";  // <- anpassen

    const form = document.getElementById("artikelForm");
    const feedback = document.getElementById("feedback");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      // Daten aus Formular lesen
      const artikel = {
        titel: document.getElementById("titel").value,
        beschreibung: document.getElementById("beschreibung").value,
        preis: parseFloat(document.getElementById("preis").value),
        bild_url: document.getElementById("bild_url").value,
        typ: document.getElementById("typ").value
      };

      // Anfrage an Supabase senden
      try {
        const response = await fetch(`${SUPABASE_URL}/rest/v1/artikel`, {
          method: "POST",
          headers: {
            apikey: SUPABASE_KEY,
            Authorization: `Bearer ${SUPABASE_KEY}`,
            "Content-Type": "application/json",
            Prefer: "return=representation"
          },
          body: JSON.stringify(artikel)
        });

        if (!response.ok) {
          throw new Error(`Fehler: ${response.status}`);
        }

        const data = await response.json();
        feedback.textContent = `‚úÖ Artikel "${data[0].titel}" erfolgreich hinzugef√ºgt!`;
        feedback.style.color = "green";
        form.reset();
      } catch (err) {
        console.error("Fehler beim Hinzuf√ºgen:", err);
        feedback.textContent = "‚ùå Fehler beim Speichern des Artikels!";
        feedback.style.color = "red";
      }
    });
  </script>
</body>
</html>
